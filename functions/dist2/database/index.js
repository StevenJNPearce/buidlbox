'use strict';var _extends=Object.assign||function(a){for(var c,b=1;b<arguments.length;b++)for(var d in c=arguments[b],c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d]);return a},_=require('lodash'),admin=require('firebase-admin'),databaseSearch=function(a){var b=a.branch,c=b===void 0?[]:b,d=a.boundaries,e=d===void 0?{}:d,f=a.order,g=f===void 0?{}:f;return new Promise(function(h,j){var k=[],l=admin.database().ref('/'+_.join(c,'/'));g&&g.orderByKey&&(l=l.orderByKey()),g&&g.orderByChild&&(l=l.orderByChild(g.orderByChild)),g&&g.orderByValue&&(l=l.orderByValue(g.orderByValue)),e&&e.limitToFirst&&500>e.limitToFirst&&(l=l.limitToFirst(e.limitToFirst)),e&&e.limitToLast&&500>e.limitToLast&&(l=l.limitToLast(e.limitToLast)),e&&e.startAt&&(l=l.startAt(e.startAt)),e&&e.endAt&&(l=l.endAt(e.endAt)),e&&e.equalTo&&(l=l.equalTo(e.equalTo)),e&&e.child&&(l=l.child(e.child)),l.on('child_added',function(m){return m?k.push(m.val()):j(new Error('Firebase Error: the admin.database.ref in databaseSearch() is originating the error.'))}),l.once('value',function(){h(g&&g.reverse?k.reverse():k)})})},databaseRead=function(a){var b=a.branch,c=b===void 0?[]:b,d=a.boundaries,e=d===void 0?{}:d,f=a.order,g=f===void 0?{}:f;return new Promise(function(h){var l=admin.database().ref('/'+_.join(c,'/'));l.once('value',function(m){h(m.val())})})},databaseReadSingle=function(a){var b=a.branch,c=b===void 0?[]:b,d=a.boundaries,e=d===void 0?{}:d,f=a.order,g=f===void 0?{}:f;return new Promise(function(h){var l=admin.database().ref('/'+_.join(c,'/'));l.once('value',function(m){h(m.val())})})};function databaseWrite(a){var b=a.branch,c=b===void 0?[]:b,d=a.payload,e=d===void 0?{}:d,f=a.writeType,g=f===void 0?'push':f,h=a.boundaries,j=h===void 0?{}:h,k=a.order,l=k===void 0?{}:k,m=admin.database().ref(''+_.join(c,'/'));switch(g){case'push':try{var n=m.push(_extends({},e)),o=admin.database().ref(''+(_.join(c,'/')+'/'+n));return o.update({pointer:n}),n}catch(n){return{message:n.message}}break;case'update':try{var n=m.update(_extends({},e));return n}catch(n){return console.log(n),{message:n.message}}break;case'set':try{var n=m.set(_extends({},e));return n}catch(n){return{message:n.message}}break;default:return{message:'error: databaseWrite failed because writeType default is null. Please select push, update or set.'};}}var isObject=function(a){return!('[object Object]'!==Object.prototype.toString(a))},toArray=function(a){var b=[];return a.forEach(function(c){var d=c.val();isObject(d)&&(d.id=c.key),b.push(d)}),b};module.exports={databaseRead:databaseRead,databaseReadSingle:databaseReadSingle,databaseSearch:databaseSearch,databaseWrite:databaseWrite};
//# sourceMappingURL=index.js.map